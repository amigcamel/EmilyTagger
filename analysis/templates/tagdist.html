{% extends 'base.html' %}

{% block main_content %}
<div id="h_tagdist" style="width:100%;margin: 0 auto"></div>
{% endblock main_content %}

{% block extra_js %}
	<script src="http://code.highcharts.com/highcharts.js"></script>
	<script src="http://code.highcharts.com/highcharts-3d.js"></script>
	<script src="http://code.highcharts.com/modules/exporting.js"></script>
	<script type="text/javascript">
		function plotTagDist(cat, data) {
			var ele = $('<div></div>').uniqueId(),
				div = '#'+ele.attr('id');
			$('#h_tagdist').append(ele);
		    $(div).highcharts({
		    	credits: {enabled: false},
		        chart: {
			    	backgroundColor: null,
		            type: 'pie',
		            options3d: {
		                enabled: true,
		                alpha: 45,
		                beta: 0
		            }
		        },
		        title: {
		            text: cat
		        },
		        tooltip: {
		            pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
		        },
		        plotOptions: {
		            pie: {
		                allowPointSelect: true,
		                cursor: 'pointer',
		                depth: 35,
		                dataLabels: {
		                    enabled: true,
		                    format: '{point.name}'
		                }
		            }
		        },
		        series: [{
		            type: 'pie',
		            name: '佔所有類別',
		            data: data
		        }]
		    });
		};

		$(function() {
			$.post('{% url "controls" %}', {command: 'pack_tagged_words'}, function(resp) {
				var tagdist = JSON.parse(resp),
					data = [];
				$.each(tagdist, function(k, v) {
					$.each(v, function(kk, vv) {
						data.push([kk, vv.length])
					});
					plotTagDist(k, data);
				});
			});
		});
	</script>
{% endblock extra_js %}